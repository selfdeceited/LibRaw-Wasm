{
  "version": 3,
  "sources": ["../index.js"],
  "sourcesContent": ["export default class LibRaw {\r\n\tconstructor() {\r\n\t\tthis.worker = new Worker(new URL('./worker.js', import.meta.url), {type:\"module\"});\r\n\t\tthis.waitForWorker = false;\r\n\t\tthis.worker.onmessage = ({data}) => {\r\n\t\t\tif(this.waitForWorker) {\r\n\t\t\t\tlet {\"return\": ret, \"throw\": thr} = this.waitForWorker;\r\n\t\t\t\tthis.waitForWorker = false;\r\n\t\t\t\tif(data?.error) {\r\n\t\t\t\t\tthr(data.error);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tret(data?.out);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tasync runFn(fn, ...args) {\r\n\t\tlet prom = new Promise((res, err)=>{\r\n\t\t\tthis.waitForWorker = {\r\n\t\t\t\terror: err,\r\n\t\t\t\treturn: res,\r\n\t\t\t};\r\n\t\t});\r\n\t\tthis.worker.postMessage({fn, args}, args.map(a=>{\r\n\t\t\tif([ArrayBuffer, Uint8Array, Int8Array, Uint16Array, Int16Array, Uint32Array, Int32Array, Float32Array, Float64Array].some(b=>a instanceof b)) { // Transfer buffer\r\n\t\t\t\treturn a.buffer;\r\n\t\t\t}\r\n\t\t}).filter(a=>a));\r\n\t\treturn await prom;\r\n\t}\r\n\t/**\r\n\t * Open/parse the RAW data with optional settings\r\n\t */\r\n\tasync open(buffer, settings) {\r\n\t\treturn await this.runFn('open', buffer, settings);\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve metadata\r\n\t */\r\n\tasync metadata(fullOutput) {\r\n\t\tlet metadata = await this.runFn('metadata', !!fullOutput);\r\n\t\t// Example: convert numeric thumb_format to a string\r\n\t\tif (metadata?.hasOwnProperty('thumb_format')) {\r\n\t\t\tmetadata.thumb_format = [\r\n\t\t\t\t'unknown',\r\n\t\t\t\t'jpeg',\r\n\t\t\t\t'bitmap',\r\n\t\t\t\t'bitmap16',\r\n\t\t\t\t'layer',\r\n\t\t\t\t'rollei',\r\n\t\t\t\t'h265'\r\n\t\t\t][metadata.thumb_format] || 'unknown';\r\n\t\t}\r\n\t\t// Trim desc if present\r\n\t\tif (metadata?.hasOwnProperty('desc')) {\r\n\t\t\tmetadata.desc = String(metadata.desc).trim();\r\n\t\t}\r\n\t\tif (metadata?.hasOwnProperty('timestamp')) {\r\n\t\t\tmetadata.timestamp = new Date(metadata.timestamp);\r\n\t\t}\r\n\t\treturn metadata;\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieve processed image data (synchronously from the perspective of C++,\r\n\t * but we've already awaited the module & instance.)\r\n\t */\r\n\tasync imageData() {\r\n\t\treturn await this.runFn('imageData');\r\n\t}\r\n\r\n\t/**\r\n     * Retrieve the embedded JPEG preview (Fast extraction)\r\n     */\r\n    async thumbnailData() {\r\n        return await this.runFn('thumbnailData');\r\n    }\r\n}"],
  "mappings": "AAAA,IAAqBA,EAArB,KAA4B,CAC3B,aAAc,CACb,KAAK,OAAS,IAAI,OAAO,IAAI,IAAI,cAAe,YAAY,GAAG,EAAG,CAAC,KAAK,QAAQ,CAAC,EACjF,KAAK,cAAgB,GACrB,KAAK,OAAO,UAAY,CAAC,CAAC,KAAAC,CAAI,IAAM,CACnC,GAAG,KAAK,cAAe,CACtB,GAAI,CAAC,OAAUC,EAAK,MAASC,CAAG,EAAI,KAAK,cACzC,KAAK,cAAgB,GAClBF,GAAM,MACRE,EAAIF,EAAK,KAAK,EAEdC,EAAID,GAAM,GAAG,CAEf,CACD,CACD,CAEA,MAAM,MAAMG,KAAOC,EAAM,CACxB,IAAIC,EAAO,IAAI,QAAQ,CAACC,EAAKC,IAAM,CAClC,KAAK,cAAgB,CACpB,MAAOA,EACP,OAAQD,CACT,CACD,CAAC,EACD,YAAK,OAAO,YAAY,CAAC,GAAAH,EAAI,KAAAC,CAAI,EAAGA,EAAK,IAAII,GAAG,CAC/C,GAAG,CAAC,YAAa,WAAY,UAAW,YAAa,WAAY,YAAa,WAAY,aAAc,YAAY,EAAE,KAAKC,GAAGD,aAAaC,CAAC,EAC3I,OAAOD,EAAE,MAEX,CAAC,EAAE,OAAOA,GAAGA,CAAC,CAAC,EACR,MAAMH,CACd,CAIA,MAAM,KAAKK,EAAQC,EAAU,CAC5B,OAAO,MAAM,KAAK,MAAM,OAAQD,EAAQC,CAAQ,CACjD,CAKA,MAAM,SAASC,EAAY,CAC1B,IAAIC,EAAW,MAAM,KAAK,MAAM,WAAY,CAAC,CAACD,CAAU,EAExD,OAAIC,GAAU,eAAe,cAAc,IAC1CA,EAAS,aAAe,CACvB,UACA,OACA,SACA,WACA,QACA,SACA,MACD,EAAEA,EAAS,YAAY,GAAK,WAGzBA,GAAU,eAAe,MAAM,IAClCA,EAAS,KAAO,OAAOA,EAAS,IAAI,EAAE,KAAK,GAExCA,GAAU,eAAe,WAAW,IACvCA,EAAS,UAAY,IAAI,KAAKA,EAAS,SAAS,GAE1CA,CACR,CAMA,MAAM,WAAY,CACjB,OAAO,MAAM,KAAK,MAAM,WAAW,CACpC,CAKG,MAAM,eAAgB,CAClB,OAAO,MAAM,KAAK,MAAM,eAAe,CAC3C,CACJ",
  "names": ["LibRaw", "data", "ret", "thr", "fn", "args", "prom", "res", "err", "a", "b", "buffer", "settings", "fullOutput", "metadata"]
}
